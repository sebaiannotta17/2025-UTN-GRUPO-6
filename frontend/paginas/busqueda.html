<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Marketplace ‚Äî B√∫squeda</title>
    <link rel="stylesheet" href="../css/estiloMain.css" />
    <link rel="stylesheet" href="../css/busqueda.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="container">
        <a href="./main.html" class="logo">MaterialesYA</a>

        <div class="header-actions">
          <a href="./main.html" class="btn btn-secondary">Inicio</a>
          <a href="./carga.html" class="btn btn-secondary">Publicar</a>
          <button id="btn-favoritos" class="btn btn-secondary" style="display:none">‚≠ê Favoritos</button>
          <button id="btn-carrito" class="btn btn-secondary" style="display:none">
            üõí Carrito
            <span id="carrito-badge" class="carrito-badge" style="display:none">0</span>
          </button>

          <a href="./login.html" class="btn btn-primary" id="nav-login-btn">Login</a>
          <a href="./perfil.html" class="btn btn-primary" id="nav-perfil-btn" style="display:none">Mi perfil</a>
          <button id="nav-logout-btn" class="btn btn-secondary" style="display:none; margin-left:10px">Cerrar sesi√≥n</button>
        </div>
      </div>
    </header>

    <main class="container">
      <h1>Buscar materiales</h1>

      <form id="searchForm" role="search" autocomplete="off" class="search-form">
        <input
          id="q"
          name="q"
          type="search"
          placeholder="Cemento, arena, ladrillo‚Ä¶"
          required
        />
        <button type="submit" id="btnSearch" class="btn btn-primary">Buscar</button>
      </form>

      <!-- Filtro de orden -->
      <div class="toolbar">
        <label for="sortFilter" class="sr-only">Ordenar</label>
        <select id="sortFilter">
          <option value="default">Ordenar por...</option>
          <option value="titulo-asc">T√≠tulo: A-Z</option>
          <option value="titulo-desc">T√≠tulo: Z-A</option>
          <option value="precio-asc">Precio: Menor a mayor</option>
          <option value="precio-desc">Precio: Mayor a menor</option>
        </select>
      </div>

      <!-- Resultados -->
      <ul id="results" class="grid" aria-live="polite"></ul>

      <!-- Paginaci√≥n -->
      <div id="controlpagina" class="pager">
        <button id="prevPage" class="btn" disabled>Anterior</button>
        <span id="pageInfo">P√°gina 1</span>
        <button id="nextPage" class="btn" disabled>Siguiente</button>
      </div>
    </main>

    <!-- Modal de detalle (√∫nico) -->
    <div
      id="materialModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
    >
      <div class="modal-backdrop" data-close="1"></div>
      <div class="modal-card">
        <!-- ‚ùå Cerrar -->
        <button
          class="modal-close"
          aria-label="Cerrar"
          title="Cerrar"
          data-close="1"
        >‚úï</button>

        <div class="modal-content">
          <div id="mThumb" class="modal-thumb">
            <img
              src="/imgs/default.png"
              alt="Vista detallada"
            />
          </div>

          <h2 id="mName">Nombre del Material</h2>

          <p id="mDesc" class="muted">
            Breve descripci√≥n del material.
          </p>

          <p id="mLongDesc" class="longdesc">
            Descripci√≥n larga y detallada del producto, incluyendo especificaciones t√©cnicas y uso recomendado.
          </p>

          <div id="mPrice" class="price">$0</div>

          <div class="m-extra">
            <div>
              <strong>Categor√≠a:</strong>
              <span id="mCategory">‚Äî</span>
            </div>
            <div>
              <strong>Cantidad en Stock:</strong>
              <span id="mQty">‚Äî</span>
            </div>
          </div>

          <ul id="mDetails">
            <li>Sin datos adicionales</li>
          </ul>

          <div class="modal-actions">
            <button class="btn btn-primary btn-carrito">
              üõí A√±adir al Carrito
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Favoritos -->
    <div id="modal-favoritos" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>‚≠ê Mis Favoritos</h2>
          <button id="close-modal-favoritos" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <p id="favoritos-feedback">Cargando favoritos...</p>
          <ul id="favoritos-grid" class="grid"></ul>
        </div>
      </div>
    </div>

    <!-- Modal del Carrito -->
    <div id="modal-carrito" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>üõí Mi Carrito</h2>
          <button id="close-modal-carrito" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <p id="carrito-feedback">Cargando carrito...</p>
          <ul id="carrito-grid" class="carrito-list"></ul>
          <div class="carrito-footer">
            <p id="carrito-total" class="carrito-total">Total: $0</p>
            <div class="carrito-info-box">
              <p><strong>üí° ¬øC√≥mo comprar?</strong></p>
              <p>Para cada producto puedes contactar directamente con su vendedor usando el bot√≥n "ÔøΩ Contactar Vendedor" que aparece en cada item del carrito.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="toast-container"></div>
    <script src="../js/favoritos.js"></script>
    <script src="../js/carrito.js"></script>
    <script src="../js/vendedor.js"></script>
    <script src="../js/busqueda.js" type="module"></script>
  </body>
</html>
