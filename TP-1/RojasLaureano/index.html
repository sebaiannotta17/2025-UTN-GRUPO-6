<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TP1 TyG Web</title>
  <link rel="stylesheet" href="estilos.css" />
  <link rel="icon" href="doom slayer logo.png">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <div class="grid-container">
    
    <header class="main-header">
      <div class="logo">
        <img src="doom slayer logo.png" alt="Logo">
      </div>
      <h1 class="titulo">TP1 - Laureano Rojas</h1>
    </header>

    <nav class="sidebar">
      <button id="api1">API 1</button>
      <button id="api2">API 2</button>
    </nav>

    <main class="contenido">
      
      
    </main>

    <footer class="main-footer">
      <div class="pie">
        <h2>TyG WEB 2025</h2>
      </div>
    </footer>

  </div>
  <script>
  $(document).ready(function () {

  const frases = [
    {
      texto: "ALOHA LOQUITASS",
      clase: "frase1"
    },
    {
      texto: "SAPEEE!!",
      clase: "frase2"
    },
    {
      texto: "SALUTEE!!",
      clase: "frase3"
    }
  ];

  const seleccion = frases[Math.floor(Math.random() * frases.length)];

  $(".contenido").html(`
    <div class="frase-inicial ${seleccion.clase}">
      <h2>${seleccion.texto}</h2>
    </div>
    <p id="expectativa">Mi expectativa en esta materia es aprender herramientas de desarrollo Front-End</p>
  `);
    
    $("#api1").on("click", function () {
      $(".contenido").html(`
        <div class="busqueda-container">
          <div class="busqueda">
            <input type="text" id="buscador" placeholder="Busca una película" />
            <button id="buscarBtn">Buscar</button>
          </div>
          <div id="resultados" class="resultados"></div>
        </div>
`     );
    });

    $(document).on("click", "#buscarBtn", function () {
      const query = $("#buscador").val().trim();
      if (query.length < 3) {
        alert("Escribí al menos 3 letras.");
        return;
      }

      $("#resultados").html("Cargando...");

      $.ajax({
        url: `https://imdb.iamidiotareyoutoo.com/search?q=${encodeURIComponent(query)}`,
        method: "GET",
        success: function (data) {
          console.log(data);

          const resultados = data.description;

          if (!resultados || resultados.length === 0) {
            $("#resultados").html("No se encontraron resultados.");
            return;
          }

          const html = resultados.map(pelicula => `
            <div class="pelicula">
             <img src="${pelicula['#IMG_POSTER']}" alt="${pelicula['#TITLE']}" />
              <h3>${pelicula['#TITLE']}</h3>
              <p>${pelicula['#YEAR'] || 'Año desconocido'}</p>
            </div>
          `).join('');

          $("#resultados").html(html);
        },
        error: function () {
          $("#resultados").html("Error al buscar películas.");
        }
      });
    });

    $("#api2").on("click", function () {
    $(".contenido").html(`
      <div class="trivias">
        <h2>Preguntas Trivia</h2>
        <div id="triviaContainer">Cargando preguntas...</div>
      </div>
    `);

    $.ajax({
      url: "https://opentdb.com/api.php?amount=5",
      method: "GET",
      success: function (data) {
        const preguntas = data.results;

        if (!preguntas || preguntas.length === 0) {
          $("#triviaContainer").html("No se encontraron preguntas.");
          return;
        }
        function mezclarArray(array) {
          return array.sort(() => Math.random() - 0.5);
        }

        const html = preguntas.map((pregunta, index) => {
          const respuestas = [...pregunta.incorrect_answers, pregunta.correct_answer];
          const opcionesMezcladas = mezclarArray(respuestas);

          const opcionesHtml = opcionesMezcladas.map(opcion => `
            <button class="opcion" data-respuesta="${opcion}" data-correcta="${pregunta.correct_answer}">
              ${opcion}
            </button>
          `).join("");

          return `
            <div class="pregunta">
              <h3>${index + 1}. ${pregunta.question}</h3>
              <p><strong>Categoría:</strong> ${pregunta.category}</p>
              <p><strong>Dificultad:</strong> ${pregunta.difficulty}</p>
              <div class="opciones">${opcionesHtml}</div>
              <div class="respuesta"></div>
            </div>
          `;
        }).join("");

        $("#triviaContainer").html(html);
      },

      error: function () {
        $("#triviaContainer").html("Error al cargar las preguntas.");
      }
    });
        $(document).on("click", ".opcion", function () {
      const seleccionada = $(this).data("respuesta");
      const correcta = $(this).data("correcta");
      const contenedorRespuesta = $(this).closest(".pregunta").find(".respuesta");

      if (seleccionada === correcta) {
        contenedorRespuesta.html(`<p style="color:lime;"> Correcto</p>`);
      } else {
        contenedorRespuesta.html(`<p style="color:orange;">Incorrecto. La respuesta correcta era: <strong>${correcta}</strong></p>`);
      }
      $(this).siblings().addBack().prop("disabled", true);
    });
  });
});
</script>

</body>
</html>
